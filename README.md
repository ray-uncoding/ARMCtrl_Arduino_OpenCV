# 🤖 ARMCtrl OpenCV 專案 README（v2 架構）

## 📘 專案簡介
本專案是一套結合 Python + OpenCV + PyQt5 + Arduino 的「色彩與形狀辨識系統」，
支援兩種模式：HSV 編輯模式與自動運作模式，可應用於簡易機器手臂觸發與控制。

---

## 📂 專案架構

```
ARMCtrl_OpenCV/
├── main_ui.py              ← 主介面入口，僅控制顯示與模式切換
├── controller/             ← 控制模組
│   ├── hsv_editor.py       ← 編輯模式：拉條調整、儲存、刪除紀錄
│   ├── auto_runner.py      ← 自動模式：比對色彩、輪廓、發送指令
├── core/                   ← 技術模組
│   ├── camera_stream.py    ← 攝影機串流與畫面擷取
│   ├── hsv_filter.py       ← HSV 範圍過濾函式
│   ├── object_detector.py  ← 輪廓分析（近似形狀 + 面積）
│   ├── json_storage.py     ← 顏色紀錄儲存/刪除/載入功能
│   ├── serial_sender.py    ← 傳送簡碼給 Arduino（例如 "a"）
├── color_db.json           ← 所有顏色與 HSV 記錄檔案
├── img/                    ← 使用說明圖、架構圖（可選）
├── README.md               ← 本文件
```

---

## 🧠 使用說明

### ✨ 雙模式切換功能

#### ✅ HSV 編輯模式（預設）
- 調整 H/S/V 三組滑條，觀察過濾效果
- 命名並儲存對應顏色至資料庫（color_db.json）
- 可選擇已存顏色 → 套用到滑條上進行編輯

#### ✅ 自動運作模式
- 禁用滑條與儲存控制
- 每幀畫面遍歷所有已紀錄的顏色設定：
  - 套用 HSV 篩選
  - 使用輪廓偵測確認是否為 **矩形** 且 **面積夠大**
  - 若符合，傳送顏色名稱第一字元（如 "r"、"g"）給 Arduino
  - 每次傳送後間隔 2 秒避免重複

---

## 📤 傳送機制（即將加入）

| 符號 | 說明           | Arduino 對應 | 備註            |
|------|----------------|----------------|-----------------|
| A    | 紅色方形       | `0001`         | 透過繼電器控制  |
| B    | 藍色三角形     | `0010`         | 可擴充其他條件  |

> 訊號定義將統一寫在 `serial_sender.py` 或對照表 json 中

---

## 🎯 預計功能（開發中）

- [ ] 訊號傳輸規則設計（支援 A=0001，B=0010...）
- [ ] UI 色彩 + 形狀條件組合（紅色 + 方形才能觸發）
- [ ] 選色筆：畫面中點選像素，自動轉換為 HSV 範圍
- [ ] 調整儲存格式支援形狀分類與對應訊號
- [ ] 儲存時間戳記與傳送記錄 Log 功能

---

## 🛠 執行方式

```bash
python main_ui.py
```
> 執行後請確保鏡頭正常開啟，並已連接 Arduino 裝置（COM3 等）

---

## 📬 聯絡與貢獻

本專案由 @Ray 及開發夥伴協作製作。
歡迎透過 PR 或 Issues 提出功能建議與錯誤修正 🙌